<% parents = performance_measure.parents %>
<div class="panel panel-info" data-measure-id="<%= performance_measure.id %>" data-objective-kfa="<%= parents[0].name %>" data-objective-name="<%= parents[1].name %>">
  <div class="panel-body">
    
    <% parents.each_with_index do |parent, idx| %>
      <div class="row">
        
        <label class="col-sm-3 control-label limit-text capitalize"><%= parent.model_name.human %></label>
        
        <div class="col-sm-9 layout-row layout-align-space-between-stretch">
          
          <p><%= parent.try(:name) %></p>
          
          <% if idx == 0 %>
            <div class="kfa-logo-card">
              <%= image_tag parent.logo.url(:thumb), alt: "Key Focus Area logo", class: "img-responsive" if parent.logo.present? %>
            </div>
          <% end -%>

        </div>
      </div>
    <% end %>
    
    <div class="row">
      <label class="col-sm-3 control-label limit-text capitalize">Description</label>
      <div class="col-sm-9">
        <p><%= performance_measure.description %></p>
      </div>
    </div>

    <div class="row">
      <label class="col-sm-3 control-label limit-text capitalize">target</label>
      <div class="col-sm-9">
        <p><%= performance_measure.target %></p>
      </div>
    </div>

    <% if action_name == 'show' %>

      <div class="row">
        <label class="col-sm-3 control-label limit-text capitalize">unit of measure</label>
        <div class="col-sm-9">
          <p><%= performance_measure.unit_of_measure %></p>
        </div>
      </div>

      <div class="row">
        <label class="col-sm-3 control-label limit-text capitalize">measurement formula</label>
        <div class="col-sm-9">
          <p><%= performance_measure.measurement_formula %></p>
        </div>
      </div>

      <div class="row">
        <label class="col-sm-3 control-label limit-text capitalize">data source</label>
        <div class="col-sm-9">
          <p><%= performance_measure.data_source %></p>
        </div>
      </div>

      <div class="row">
        <label class="col-sm-3 control-label limit-text capitalize">Rationale for Target</label>
        <div class="col-sm-9">
          <p><%= performance_measure.rationale_for_target %></p>
        </div>
      </div>

      <div class="row">
        <label class="col-sm-3 control-label limit-text capitalize">Performance Factors</label>
        <% factors = performance_measure.performance_factors %>
        <div class="col-sm-9">
          <%= content_tag :p, "N/A" if factors.length == 0 %>
          <ul>
          <% factors.each do |factor| %>
            <li><%= factor.label_text %></li>
          <% end %>
          </ul>
        </div>
      </div>
      
      <div class="row">
        <div class="col-xs-12">
          <h5 class="md-primary">Data Contact</h5>
        </div>
      </div>
      
      <div class="row">
        <label class="col-sm-3 control-label limit-text capitalize">Name</label>
        <div class="col-sm-9">
          <p><%= performance_measure.data_contact_person %></p>
        </div>
      </div>

      <div class="row">
        <label class="col-sm-3 control-label limit-text capitalize">Email</label>
        <div class="col-sm-9">
          <p><%= performance_measure.data_contact_person_email %></p>
        </div>
      </div>

      <div class="row">
        <div class="col-xs-12">
          <h5 class="md-primary">Person Reporting to BMS</h5>
        </div>
      </div>

      <div class="row">
        <label class="col-sm-3 control-label limit-text capitalize">Name</label>
        <div class="col-sm-9">
          <p><%= performance_measure.person_reporting_data_to_bms %></p>
        </div>
      </div>

      <div class="row">
        <label class="col-sm-3 control-label limit-text capitalize">Email</label>
        <div class="col-sm-9">
          <p><%= performance_measure.person_reporting_data_to_bms_email %></p>
        </div>
      </div>

      <div class="row">
        <div class="col-xs-12">
          <h5 class="md-primary">Extras</h5>
        </div>
      </div>

      <div class="row">
        <label class="col-sm-3 control-label limit-text capitalize">Notes</label>
        <div class="col-sm-9">
          <p><%= performance_measure.notes %></p>
        </div>
      </div>

      <div class="row">
        <label class="col-sm-3 control-label limit-text">Created By</label>
        <div class="col-sm-9">
          <p><%= performance_measure.author.try(:email) %></p>
        </div>
      </div>

      <div class="row">
        <label class="col-sm-3 control-label limit-text">Last Edited by</label>
        <div class="col-sm-9">
          <p><%= performance_measure.last_editor.try(:email) %></p>
        </div>
      </div>
    <% end %>


    <% if action_name == "index" %>
      <div class="row">
        <label class="col-sm-3 control-label limit-text capitalize">Data Contact</label>
        <div class="col-sm-9">
          <p><%= performance_measure.data_contact_person %></p>
          <p><%= performance_measure.data_contact_person_email %></p>
        </div>
      </div>

      <div class="row">
        <label class="col-sm-3 control-label limit-text capitalize">Person Reporting to BMS</label>
        <div class="col-sm-9">
          <p><%= performance_measure.person_reporting_data_to_bms %></p>
          <p><%= performance_measure.person_reporting_data_to_bms_email %></p>
        </div>
      </div>
    <% end -%>
    
    <%= render partial: "shared/card_actions", locals: { resource: performance_measure } %>

  </div>
</div>